---
title: "Relationship Between Upper Respiratory Tract Infection in Pregnancy and Adverse Birth Outcomes"
subtitle: "BMIN503/EPID600 Final Project"
author: "Sarah Rothbard"
format: html
editor: visual
number-sections: true
embed-resources: true
---

------------------------------------------------------------------------

## Overview {#sec-overview}

For my final project, it is my goal to understand the relationship between pre-conception iron biomarkers and miscarriage risk. Specifically, I will be investigating this question among women with prior pregnancy loss, using data from the EAGeR (Effects of Aspirin in Gestation and Reproduction) trial.

Two faculty members I met with to discuss this project: Sunni Mumford, Professor & Deputy Director, Epidemiology Ellen Caniglia, Assistant Professor, Epidemiology

Sunni Mumford has worked with EAGeR data before and informed me about the EAGeR data structure and best practices for the analyses. We discussed the feasibility of my research question; data is available within EAGeR on both iron biomarkers and miscarriage. Iron biomarker data is from baseline (preconception) and pregnancy loss data is collected during follow-up with the time metric being gestational weeks until miscarriage or birth. Ellen Caniglia encouraged me to perform a literature review to determine which iron biomarker may be best to use and after discussion, we decided on serum ferritin. With both Dr. Mumford and Dr. Caniglia, I discussed potential confounders based on the literature.

[srothbard](https://github.com/srothbard/BMIN503_Final_Project)

## Introduction {#sec-introduction}

Miscarriage, defined as the spontaneous loss of a pregnancy before 20 weeks of gestation, is a common and emotionally devastating outcome, affecting approximately 10–20% of recognized pregnancies. Despite its prevalence, the underlying causes of miscarriage are not fully understood, particularly among women with a history of pregnancy loss. Iron, an essential micronutrient involved in oxygen transport, hormone synthesis, and cellular function, plays a critical role in reproductive health. Iron deficiency—even in the absence of anemia—has been associated with impaired implantation, placental development, and increased miscarriage risk. Serum ferritin, a biomarker of iron stores, is particularly relevant in assessing iron status in women of reproductive age. This final project aims to investigate whether preconception serum ferritin levels are associated with miscarriage risk among women with prior pregnancy loss, using data from the EAGeR (Effects of Aspirin in Gestation and Reproduction) trial. This research is inherently interdisciplinary, integrating perspectives from epidemiology, reproductive biology, nutrition science, and biostatistics. Epidemiological methods are essential for analyzing longitudinal data and identifying confounding factors, while reproductive biology provides insight into how iron status may influence implantation and early gestational development. Nutrition science contributes to understanding iron metabolism and its biomarkers, and biostatistics enables rigorous modeling of time-to-event outcomes. The EAGeR trial provides a unique opportunity to explore the relationship between serum ferritin and miscarriage, as it includes detailed data on preconception serum ferritin levels and prospective tracking of pregnancy outcomes by gestational week. Identifying relevant confounders such as age, BMI, and parity is essential for isolating the true effect of iron status, and integrating insights from epidemiology, nutrition science, and reproductive biology is critical to fully understanding this complex relationship.

## Methods {#sec-methods}

**Study Population** This study utilizes data from the Effects of Aspirin in Gestation and Reproduction (EAGeR) trial, a multi-site randomized controlled trial designed to evaluate the impact of low-dose aspirin on reproductive outcomes. The analytic sample includes 1,228 women aged 18–40 years who had experienced one or two prior pregnancy losses and were actively attempting to conceive. Participants were followed until miscarriage or birth occurred, with pregnancy outcomes tracked in gestational weeks.

**Exposure Assessment** The primary exposure of interest is iron status, measured via serum ferritin concentrations at baseline (preconception). Serum ferritin was assessed using standardized immunoassays, with quality control procedures including re-testing of samples to ensure reliability. Serum ferritin is selected as the primary biomarker due to its clinical relevance and widespread use in assessing iron stores. Iron deficiency is commonly defined as serum ferritin \<15 µg/L by the World Health Organization (WHO), but recent literature suggests a cutoff of \<30 µg/L may improve sensitivity and specificity in both healthy and clinical populations. Ferritin levels are dichotomized at the \<30 µg/L threshold for analysis.

**Outcome Measurement** The primary outcome is miscarriage, defined as a chemical or clinical loss of pregnancy. 

**Covariates** Potential confounders were identified through literature review and include: age, Body Mass Index (BMI), race/ethnicity, parity, household income, educational attainment, use of prenatal vitamins, physical activity, and aspirin treatment assignment. Smoking status was inconsistently measured and is excluded from primary analyses.

**Statistical Analysis** Descriptive statistics summarize the distribution of serum ferritin and covariates. Table 1 presents baseline characteristics stratified by serum ferritin status (\<30 µg/L vs. ≥30 µg/L). Risk ratios are estimated using a Poisson regression model with a log link and robust standard errors, implemented via the survey package (svyglm) in R. This approach is widely recommended as an alternative to log-binomial models, which often fail to converge in the presence of complex covariate adjustment or weighting. Initial models are unadjusted, followed by adjusted models incorporating identified covariates. Inverse probability weights were applied to account for selection into pregnancy. Sensitivity analyses explore the use of the WHO ferritin cutoff as an alternative metric for iron deficiency and stratifying by potential effect modifiers.

```{r}
#load packages
library(labelled)
library(haven)
library(dplyr)

#Read in SAS dataset
merged_all <- read_sas("C:\\Users\\sarahrot\\Box\\Sarah - EAGeR data\\merged_all.sas7bdat")

#create a new data frame with transformations
pretbl1 <- merged_all %>%
  dplyr::mutate(
    # Categories for serum ferritin
    ferritin30cat = dplyr::case_when(
      !is.na(ferritin) & ferritin < 30 ~ 1,
      ferritin >= 30 ~ 2
    ),
    ferritin15cat = dplyr::case_when(
      !is.na(ferritin) & ferritin < 15 ~ 1,
      ferritin >= 15 ~ 2
    ),
    
    # Age categories
    agecat = dplyr::case_when(
      age > 18 & age < 23 ~ 1,
      age >= 23 & age < 28 ~ 2,
      age >= 28 & age < 33 ~ 3,
      age >= 33 & age < 38 ~ 4,
      age >= 38 ~ 5
    ),
    
    # BMI categories
    bmicat = dplyr::case_when(
      is.na(BMI) ~ NA_real_,
      BMI < 25 ~ 1,
      BMI >= 25 & BMI <= 30 ~ 2,
      BMI > 30 ~ 3
    ),
    
    # Parity categories
    parity = dplyr::case_when(
      Preg_no_loss == 0 ~ 0,
      Preg_no_loss %in% c(1, 2, 3) ~ 1
    ),
    
    # Income categories
    income = dplyr::case_when(
      DMGv34 %in% c(1, 2) ~ 1,
      DMGv34 %in% c(3, 4) ~ 2,
      DMGv34 == 5 ~ 3
    ),
    
    # Education categories
    education2 = dplyr::case_when(
      education == "> High School" ~ education,
      education %in% c("High-school graduate", "Not High-school graduate") ~ "Some high school or high school graduate"
    )
  )

#Labeling values of variables based on data dictionary
pretbl1$bmicat <- factor(pretbl1$bmicat,
                         levels = c(1, 2, 3),
                         labels = c("1: <25", "2: 25–30", "3: >30"))
pretbl1$income <- factor(pretbl1$income,
                         levels = c(1, 2, 3),
                         labels = c("1: <$40,000", "2: $40,000–$99,999", "3: ≥$100,000"))
pretbl1$white <- factor(pretbl1$white, levels = c(0, 1), labels = c("Non-white", "White"))
pretbl1$is_treatment <- factor(pretbl1$is_treatment, levels = c(0, 1), labels = c("Control", "Treatment"))
pretbl1$ferritin30cat <- factor(pretbl1$ferritin30cat,
                                levels = c(1, 2),
                                labels = c("1: <30 microgram/L", "2: ≥30 microgram/L"))
pretbl1$ferritin15cat <- factor(pretbl1$ferritin15cat,
                                levels = c(1, 2),
                                labels = c("1: <15 microgram/L", "2: ≥15 microgram/L"))
pretbl1$Exercise <- factor(pretbl1$Exercise,
                           levels = c(1, 2, 3),
                           labels = c("1: Low", "2: Moderate", "3: High"))
pretbl1$parity <- factor(pretbl1$parity,
                         levels = c(0, 1),
                         labels = c("0: Nulliparous", "1: Parous"))
pretbl1$take_vitamins[pretbl1$take_vitamins == ""] <- NA

#labeling variables themselves
var_label(pretbl1$age) <- "Age (years)"
var_label(pretbl1$bmicat) <- "BMI category"
var_label(pretbl1$income) <- "Income category"
var_label(pretbl1$parity) <- "Parity"
var_label(pretbl1$take_vitamins) <- "Prenatal Vitamin Use"
var_label(pretbl1$Exercise) <- "Exercise level"
var_label(pretbl1$is_treatment) <- "Treatment assignment"
var_label(pretbl1$ferritin30cat) <- "Serum ferritin (<30 µg/L cutoff)"
var_label(pretbl1$ferritin15cat) <- "Serum ferritin (<15 µg/L cutoff)"

```

## Results {#sec-results}

Describe your results and include relevant tables, plots, and code/comments used to obtain them. You may refer to the @sec-methods as needed. End with a brief conclusion of your findings related to the question you set out to address. You can include references if you'd like, but this is not required.

```{r}
#load packages for creating Table 1

library(gtsummary)
library(tableone)

#Table 1 (by 30 microgram/L ferritin cutoff)
tbl1_30 <- pretbl1 %>%
  select(ferritin30cat, age, bmicat, white, parity, income, education2, take_vitamins, Exercise, is_treatment) %>%
  tbl_summary(by = ferritin30cat, missing = "no") %>%
  add_p() %>%
  bold_labels()

#Table 1 (by 15 microgram/L ferritin cutoff)
tbl1_15 <- pretbl1 %>%
  select(ferritin15cat, age, bmicat, white, parity, income, education2, take_vitamins, Exercise, is_treatment) %>%
  tbl_summary(by = ferritin15cat, missing = "no") %>%
  add_p() %>%
  bold_labels()

as_gt(tbl1_30) %>%
  gt::gtsave("Table1_30ferr.docx")

as_gt(tbl1_15) %>%
  gt::gtsave("Table1_15ferr.docx")
```
Among 1,228 participants, serum ferritin levels varied across categories. Using the 30 µg/L cutoff, 342 women (27.8%) had ferritin <30 µg/L and 851 (72.2%) had ferritin ≥30 µg/L. Women with ferritin <30 µg/L were slightly younger (median age 27.8 vs. 28.4 years, p=0.037) and more likely to be parous (63% vs. 55%, p=0.012). Income also differed significantly (p=0.020), with a higher proportion of women in the <30 µg/L group reporting income <$40,000 (38% vs. 31%). Other characteristics, including BMI, race, education, prenatal vitamin use, exercise level, and treatment assignment, were similar across ferritin categories.
Using the 15 µg/L cutoff, 110 women (9.0%) had ferritin <15 µg/L and 1,083 (91.0%) had ferritin ≥15 µg/L. Women with ferritin <15 µg/L were more likely to have higher BMI (p=0.009), be parous (68% vs. 56%, p=0.014), and report lower income (p=0.012). Race also differed significantly (p=0.007), with non-White participants more common in the <15 µg/L group (11% vs. 4.8%). Exercise level varied by ferritin status (p=0.044), with low activity more frequent among women with ferritin <15 µg/L (35% vs. 25%). Age, education, prenatal vitamin use, and treatment assignment did not differ significantly between groups.

```{r}
# Fit logistic model for pregnancy
selection_model <- glm(pptnew ~ ferritin30cat + age + bmicat + white + parity + income + education2 + take_vitamins + Exercise + is_treatment,
                       data = pretbl1,
                       family = binomial)

# Compute predicted probabilities and IP weights
pretbl1 <- pretbl1 %>%
  mutate(pred_preg = predict(selection_model, newdata = pretbl1, type = "response"),
         ipw = ifelse(pptnew == 1, 1 / pred_preg, 1 / (1 - pred_preg)))

# Filter dataset for those who got pregnant
# and set level 2 as reference for ferritin30cat
subset_data <- pretbl1 %>%
  filter(pptnew == 1) %>%
  mutate(ferritin30cat = relevel(ferritin30cat, ref = "2: ≥30 microgram/L"))

subset_data <- subset_data %>% filter(!is.na(ipw))

#Cases in each group
subset_data %>%
  group_by(ferritin30cat) %>%
  summarise(
    n_anyloss = sum(anyloss == 1, na.rm = TRUE),
    total = n(),
    percent = round(100 * n_anyloss / total, 1)
  )

# Unadjusted model using survey design
library(survey)
library(broom) 

design <- svydesign(ids = ~1, weights = ~ipw, data = subset_data)

unadj_model <- svyglm(anyloss ~ ferritin30cat,
                      design = design,  # same design object with weights
                      family = quasipoisson(link = "log"))

summary(unadj_model)
exp(cbind(RR = coef(unadj_model), confint(unadj_model)))

#adjusted model

adjmodel <- svyglm(anyloss ~ ferritin30cat + age + bmicat + white + parity +
                     income + education2 + take_vitamins + Exercise + is_treatment,
                   design = design,
                   family = quasipoisson(link = "log"))

summary(adjmodel)
exp(cbind(RR = coef(adjmodel), confint(adjmodel)))
```
In total, 184 pregnancy losses occurred among 1,193 women with serum ferritin measured at baseline. Using the 30 μg/L cutoff, 144 cases occurred among women with ferritin ≥30 μg/L and 40 cases among those with ferritin <30 μg/L. In unadjusted analyses, women with ferritin <30 μg/L had a slightly lower risk of pregnancy loss compared to those with ferritin ≥30 μg/L (RR = 0.77; 95% CI: 0.56, 1.06). After adjustment for age, BMI, race, parity, income, education, prenatal vitamin use, exercise level, and aspirin treatment assignment, the association remained similar (adjusted RR = 0.82; 95% CI: 0.59, 1.12). Neither estimate reached statistical significance.

```{r}
#Sensitivity analyses

# Fit logistic model for pregnancy (different ferritin cutoff)
selection_model2 <- glm(pptnew ~ ferritin15cat + age + bmicat + white + parity + income + education2 + take_vitamins + Exercise + is_treatment,
                       data = pretbl1,
                       family = binomial)

# Compute predicted probabilities and IP weights
senset <- pretbl1 %>%
  mutate(pred_preg = predict(selection_model2, newdata = pretbl1, type = "response"),
         ipw = ifelse(pptnew == 1, 1 / pred_preg, 1 / (1 - pred_preg)))

# Filter dataset for those who got pregnant
# and set level 2 as reference for ferritin15cat
subset_data2 <- senset %>%
  filter(pptnew == 1) %>%
  mutate(ferritin15cat = relevel(ferritin15cat, ref = "2: ≥15 microgram/L"))

subset_data2 <- subset_data2 %>% filter(!is.na(ipw))

#Cases in each group
subset_data2 %>%
  group_by(ferritin15cat) %>%
  summarise(
    n_anyloss = sum(anyloss == 1, na.rm = TRUE),
    total = n(),
    percent = round(100 * n_anyloss / total, 1)
  )

# Unadjusted model using survey design
design2 <- svydesign(ids = ~1, weights = ~ipw, data = subset_data2)

unadj_model2 <- svyglm(anyloss ~ ferritin15cat,
                      design = design2,  # same design object with weights
                      family = quasipoisson(link = "log"))

summary(unadj_model2)
exp(cbind(RR = coef(unadj_model2), confint(unadj_model2)))

#adjusted model

adjmodel2 <- svyglm(anyloss ~ ferritin15cat + age + bmicat + white + parity +
                     income + education2 + take_vitamins + Exercise + is_treatment,
                   design = design2,
                   family = quasipoisson(link = "log"))

summary(adjmodel2)
exp(cbind(RR = coef(adjmodel2), confint(adjmodel2)))


# Adjusted model with interaction between ferritin and parity
interaction_model <- svyglm(anyloss ~ ferritin30cat * parity + age + bmicat + white + income + education2 + take_vitamins + Exercise + is_treatment,
                            design = design,
                            family = quasipoisson(link = "log"))
summary(interaction_model)
#significant p-value; potential effect modification by parity


#Stratification of primary model by parity

# Split data by parity
nulliparous_data <- subset_data %>% filter(parity == "0: Nulliparous")
parous_data <- subset_data %>% filter(parity == "1: Parous")

#Cases in each group
nulliparous_data %>%
  group_by(ferritin30cat) %>%
  summarise(
    n_anyloss = sum(anyloss == 1, na.rm = TRUE),
    total = n(),
    percent = round(100 * n_anyloss / total, 1)
  )

parous_data %>%
  group_by(ferritin30cat) %>%
  summarise(
    n_anyloss = sum(anyloss == 1, na.rm = TRUE),
    total = n(),
    percent = round(100 * n_anyloss / total, 1)
  )

# Create survey designs for each stratum
design_nulliparous <- svydesign(ids = ~1, weights = ~ipw, data = nulliparous_data)
design_parous <- svydesign(ids = ~1, weights = ~ipw, data = parous_data)

# Unadjusted models
unadj_nulliparous <- svyglm(anyloss ~ ferritin30cat,
                             design = design_nulliparous,
                             family = quasipoisson(link = "log"))

unadj_parous <- svyglm(anyloss ~ ferritin30cat,
                        design = design_parous,
                        family = quasipoisson(link = "log"))

# Summaries and exponentiated coefficients
exp(cbind(RR = coef(unadj_nulliparous), confint(unadj_nulliparous)))
exp(cbind(RR = coef(unadj_parous), confint(unadj_parous)))

# Adjusted models
adj_nulliparous <- svyglm(anyloss ~ ferritin30cat + age + bmicat + white +
                             income + education2 + take_vitamins + Exercise + is_treatment,
                           design = design_nulliparous,
                           family = quasipoisson(link = "log"))

adj_parous <- svyglm(anyloss ~ ferritin30cat + age + bmicat + white +
                        income + education2 + take_vitamins + Exercise + is_treatment,
                      design = design_parous,
                      family = quasipoisson(link = "log"))

# Summaries and exponentiated coefficients
exp(cbind(RR = coef(adj_nulliparous), confint(adj_nulliparous)))
exp(cbind(RR = coef(adj_parous), confint(adj_parous)))
```
In a sensitivity analysis using a 15 μg/L cutoff for serum ferritin, 12 pregnancy losses occurred among women with ferritin <15 μg/L compared to 172 losses among those with ferritin ≥15 μg/L. The unadjusted risk ratio for pregnancy loss in the <15 μg/L group was 0.80 (95% CI: 0.47, 1.38). After adjustment for covariates, the association remained similar (adjusted RR = 0.86; 95% CI: 0.50, 1.48). These findings were consistent with the primary analysis and did not indicate a statistically significant association between low ferritin and pregnancy loss.
Stratified analyses by parity using the 30 μg/L cutoff revealed differing patterns. Among nulliparous women, pregnancy loss occurred in 22 women with ferritin <30 μg/L and 61 women with ferritin ≥30 μg/L. The adjusted hazard ratio was 1.12 (95% CI: 0.71, 1.75), indicating no significant association. In contrast, among parous women, pregnancy loss occurred in 18 women with ferritin <30 μg/L and 83 women with ferritin ≥30 μg/L. Here, lower ferritin was associated with a significantly reduced risk of pregnancy loss (adjusted HR = 0.58; 95% CI: 0.37, 0.92).

## Conclusion

This the conclusion. The @sec-results can be invoked here.

## Bibliography

CDC. (2024). Data and Statistics \| Reproductive Health. Centers for Disease Control and Prevention. Retrieved from https://www.cdc.gov/reproductive-health/data-statistics/index.html

Gernand, A. D., Schulze, K. J., Stewart, C. P., West, K. P., & Christian, P. (2016). Micronutrient deficiencies in pregnancy worldwide: health effects and prevention. Nature Reviews Endocrinology, 12(5), 274–289. https://doi.org/10.1038/nrendo.2016.37

Cappellini, M. D., Santini, V., Braxs, C., & Shander, A. (2022). Iron metabolism and iron deficiency anemia in women. Fertility and Sterility, 118(4), 607–614. https://doi.org/10.1016/j.fertnstert.2022.08.014

Petraglia, F., & Dolmans, M. M. (2022). Iron deficiency anemia: Impact on women's reproductive health. Fertility and Sterility, 118(4), 605–606. https://doi.org/10.1016/j.fertnstert.2022.08.850

Mumford, S. L., et al. (2021). Markers of vitamin D metabolism and premenstrual symptoms in healthy women with regular cycles. Human Reproduction, 36(7), 1808–1820. https://doi.org/10.1093/humrep/deab089
